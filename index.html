<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Borang Saringan Kesihatan Mental (GAD-7 & PHQ-9)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 1em;
      padding: 1em;
      max-width: 600px;
      margin: auto;
    }
    h2 {
      background-color: #f0f0f0;
      padding: 10px;
      border-radius: 8px;
    }
    label, select {
      display: block;
      margin-top: 10px;
    }
    select {
      width: 100%;
      padding: 5px;
    }
    .question {
      margin-bottom: 15px;
    }
    .score-box {
      margin-top: 20px;
      padding: 15px;
      background: #eafaea;
      border: 1px solid #ccc;
      border-radius: 10px;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #4CAF50;
      color: white;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>

<h2>Borang Saringan GAD-7 & PHQ-9</h2>

<form id="mentalHealthForm">
  <label>Nama Pesakit:
    <input type="text" id="nama" required>
  </label>
  <label>No. NRIC:
    <input type="text" id="nric" required>
  </label>

  <h3>GAD-7: Skala Gangguan Kebimbangan Umum</h3>
  <div id="gad7-questions"></div>

  <h3>PHQ-9: Soal Selidik Kesihatan Pesakit</h3>
  <div id="phq9-questions"></div>

  <div class="score-box" id="resultBox">
    <strong>Jumlah Skor:</strong><br>
    GAD-7: <span id="gadScore">0</span> - <span id="gadLevel"></span><br>
    PHQ-9: <span id="phqScore">0</span> - <span id="phqLevel"></span><br>
    <div id="recommendation"></div>
  </div>

  <button type="button" onclick="calculateScore()">Kira Skor</button>
  <button type="button" onclick="copySummary()">Salin Ringkasan</button>
</form>

<script>
const gad7Questions = [
  "Berasa gugup, cemas atau 'berdebar-debar'?",
  "Tidak dapat berhenti atau mengawal rasa risau?",
  "Risau terlalu banyak mengenai pelbagai perkara?",
  "Kesukaran untuk berehat?",
  "Berasa gelisah sehingga sukar untuk duduk diam?",
  "Mudah rasa terganggu atau cepat marah?",
  "Berasa seolah-olah sesuatu yang buruk akan berlaku?"
];

const phq9Questions = [
  "Kurang minat atau keseronokan dalam melakukan sesuatu?",
  "Berasa murung, sedih, atau putus harapan?",
  "Kesukaran untuk tidur atau tidur berlebihan?",
  "Berasa letih atau kurang tenaga?",
  "Selera makan yang kurang atau berlebihan?",
  "Merasa diri gagal atau kecewa terhadap diri sendiri?",
  "Kesukaran untuk menumpukan perhatian?",
  "Bergerak atau bercakap lebih perlahan daripada biasa atau terlalu gelisah?",
  "Terfikir lebih baik mati atau mencederakan diri?"
];

const responses = [
  { text: "Tidak pernah", value: 0 },
  { text: "Beberapa hari", value: 1 },
  { text: "Lebih separuh hari", value: 2 },
  { text: "Hampir setiap hari", value: 3 }
];

function generateQuestions(containerId, questions, prefix) {
  const container = document.getElementById(containerId);
  container.innerHTML = "";
  questions.forEach((q, i) => {
    const div = document.createElement('div');
    div.className = "question";
    div.innerHTML = `<label>${i+1}. ${q}</label><select id="${prefix}${i}">` +
      responses.map(r => `<option value="${r.value}">${r.text}</option>`).join('') +
      `</select>`;
    container.appendChild(div);
  });
}

generateQuestions("gad7-questions", gad7Questions, "gad");
generateQuestions("phq9-questions", phq9Questions, "phq");

function calculateScore() {
  let gadScore = 0, phqScore = 0;
  for (let i = 0; i < gad7Questions.length; i++) {
    gadScore += parseInt(document.getElementById(`gad${i}`).value);
  }
  for (let i = 0; i < phq9Questions.length; i++) {
    phqScore += parseInt(document.getElementById(`phq${i}`).value);
  }

  document.getElementById("gadScore").textContent = gadScore;
  document.getElementById("phqScore").textContent = phqScore;
  document.getElementById("gadLevel").textContent = interpretGAD(gadScore);
  document.getElementById("phqLevel").textContent = interpretPHQ(phqScore);

  const rec = getRecommendation(gadScore, phqScore);
  document.getElementById("recommendation").innerHTML = `<strong>Cadangan:</strong> ${rec}`;
}

function interpretGAD(score) {
  if (score <= 4) return "Tiada atau ringan";
  if (score <= 9) return "Kebimbangan sederhana";
  if (score <= 14) return "Kebimbangan sederhana berat";
  return "Kebimbangan berat";
}

function interpretPHQ(score) {
  if (score <= 4) return "Tiada atau ringan";
  if (score <= 9) return "Kemurungan ringan";
  if (score <= 14) return "Kemurungan sederhana";
  if (score <= 19) return "Kemurungan sederhana berat";
  return "Kemurungan berat";
}

function getRecommendation(gad, phq) {
  if (gad >= 10 || phq >= 10) {
    return "Pertimbangkan rujukan kepada profesional kesihatan mental.";
  }
  return "Teruskan pemantauan dan sokongan kendiri.";
}

function copySummary() {
  const nama = document.getElementById("nama").value;
  const nric = document.getElementById("nric").value;
  const gad = document.getElementById("gadScore").textContent;
  const phq = document.getElementById("phqScore").textContent;
  const gadLevel = document.getElementById("gadLevel").textContent;
  const phqLevel = document.getElementById("phqLevel").textContent;
  const rec = document.getElementById("recommendation").textContent;

  const summary = `
Nama: ${nama}
NRIC: ${nric}

GAD-7 Skor: ${gad} - ${gadLevel}
PHQ-9 Skor: ${phq} - ${phqLevel}

${rec}
  `.trim();

  navigator.clipboard.writeText(summary).then(() => {
    alert("Ringkasan telah disalin ke papan klip.");
  });
}
</script>

</body>
</html>
